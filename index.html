<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Digital Earn | Professional</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        @keyframes marquee { 0% { transform: translateX(100%); } 100% { transform: translateX(-100%); } }
        .animate-marquee { display: inline-block; animation: marquee 15s linear infinite; }
        .hidden-sec { display: none !important; }
        .nav-active { color: #2563eb; }
    </style>
</head>
<body class="bg-slate-50 font-sans text-slate-900 pb-20">

    <div class="bg-blue-900 text-white overflow-hidden py-2 text-[10px] font-bold uppercase flex sticky top-0 z-[50]">
        <div class="whitespace-nowrap animate-marquee">
            ðŸš€ USER ***492 WITHDREW 2500 PKR â€” USER ***102 UPGRADED TO GOLD â€” START EARNING NOW!
        </div>
    </div>

    <div id="auth-page" class="min-h-screen flex items-center justify-center p-6">
        <div class="w-full max-w-md bg-white rounded-3xl shadow-xl p-8">
            <h1 id="auth-title" class="text-3xl font-black text-blue-900 text-center mb-6">Digital Earn</h1>
            <div class="space-y-4">
                <input id="auth-email" type="email" placeholder="Email" class="w-full p-4 bg-slate-50 rounded-2xl outline-none">
                <input id="auth-pass" type="password" placeholder="Password" class="w-full p-4 bg-slate-50 rounded-2xl outline-none">
                <div id="register-extras" class="hidden-sec grid grid-cols-3 gap-2">
                    <div onclick="selectPlan(1)" id="p-1" class="border-2 border-blue-500 p-2 rounded-xl text-center text-[10px] font-bold">BASIC<br>700</div>
                    <div onclick="selectPlan(2)" id="p-2" class="border p-2 rounded-xl text-center text-[10px]">SILVER<br>1500</div>
                    <div onclick="selectPlan(3)" id="p-3" class="border p-2 rounded-xl text-center text-[10px]">GOLD<br>2500</div>
                </div>
                <button onclick="handleAuth()" id="auth-btn" class="w-full bg-blue-600 text-white font-bold py-4 rounded-2xl">Login</button>
            </div>
            <p class="text-center mt-6 text-xs text-slate-400">
                <button onclick="toggleAuthMode()" id="toggle-btn" class="text-blue-600 font-bold">Register Now</button>
            </p>
        </div>
    </div>

    <div id="home-sec" class="hidden-sec p-6 space-y-6">
        <div class="flex items-center justify-between bg-white p-4 rounded-2xl shadow-sm">
            <div>
                <p id="top-email" class="text-xs font-bold text-slate-500">user@email.com</p>
                <span id="user-status" class="text-[9px] font-bold uppercase">Inactive</span>
            </div>
            <button onclick="logout()"><i class="fas fa-power-off text-slate-300"></i></button>
        </div>

        <div class="bg-gradient-to-br from-blue-700 to-blue-900 p-8 rounded-[35px] text-white shadow-xl relative overflow-hidden">
            <p class="text-blue-200 text-[10px] uppercase font-bold">Balance</p>
            <h1 class="text-4xl font-black italic">Rs. <span id="user-balance">0.00</span></h1>
            <i class="fas fa-gem absolute -bottom-4 -right-4 text-8xl opacity-10"></i>
        </div>

        <div class="grid grid-cols-2 gap-4">
            <div class="bg-white p-4 rounded-2xl text-center border">
                <p class="text-[9px] text-slate-400 font-bold uppercase">Tasks Left</p>
                <p id="tasks-left" class="text-xl font-bold">0</p>
            </div>
            <div class="bg-white p-4 rounded-2xl text-center border">
                <p class="text-[9px] text-slate-400 font-bold uppercase">Plan</p>
                <p id="plan-name" class="text-xl font-bold">BASIC</p>
            </div>
        </div>
    </div>

    <div id="task-sec" class="hidden-sec p-6">
        <h2 class="text-xl font-black mb-4">Daily Tasks</h2>
        <div class="bg-white p-8 rounded-3xl border border-dashed border-blue-200 text-center space-y-4">
            <div class="w-20 h-20 bg-blue-50 rounded-full flex items-center justify-center mx-auto">
                <i class="fas fa-play text-3xl text-blue-600"></i>
            </div>
            <p class="text-sm text-slate-500">Watch a 30-second ad to earn your reward.</p>
            <button onclick="doTask()" class="w-full bg-blue-600 text-white font-bold py-4 rounded-2xl">Watch Ad Now</button>
        </div>
    </div>

    <div id="profile-sec" class="hidden-sec p-6 space-y-6">
        <h2 class="text-xl font-black">My Profile</h2>
        <div class="bg-white p-6 rounded-3xl space-y-4 shadow-sm">
            <div class="flex justify-between border-b pb-2 text-sm"><span>Account</span><span id="prof-email" class="font-bold"></span></div>
            <div class="flex justify-between border-b pb-2 text-sm"><span>Plan</span><span id="prof-plan" class="font-bold"></span></div>
        </div>
        <div class="bg-slate-100 p-4 rounded-2xl text-[10px] text-slate-500">
            <p class="font-bold mb-1 uppercase">Privacy Policy</p>
            Your data is encrypted. We only collect email for login purposes. Withdrawals take 24-48 hours.
        </div>
    </div>

    <nav id="bottom-nav" class="hidden-sec fixed bottom-0 left-0 right-0 bg-white border-t flex justify-around py-4 z-[5000]">
        <button onclick="showTab('home')" class="nav-btn text-slate-400 flex flex-col items-center" id="nav-home">
            <i class="fas fa-home text-xl"></i><span class="text-[10px] font-bold">Home</span>
        </button>
        <button onclick="showTab('task')" class="nav-btn text-slate-400 flex flex-col items-center" id="nav-task">
            <i class="fas fa-tasks text-xl"></i><span class="text-[10px] font-bold">Tasks</span>
        </button>
        <button onclick="showTab('profile')" class="nav-btn text-slate-400 flex flex-col items-center" id="nav-profile">
            <i class="fas fa-user text-xl"></i><span class="text-[10px] font-bold">Profile</span>
        </button>
    </nav>

    <a href="https://wa.me/923707340477" target="_blank" class="fixed bottom-20 right-6 bg-green-500 text-white w-12 h-12 rounded-full flex items-center justify-center shadow-lg animate-bounce">
        <i class="fab fa-whatsapp text-2xl"></i>
    </a>

    <script>
        let user = JSON.parse(localStorage.getItem('user')) || null;
        let isLogin = true;
        let selLvl = 1;

        function toggleAuthMode() {
            isLogin = !isLogin;
            document.getElementById('auth-title').innerText = isLogin ? "Digital Earn" : "Register";
            document.getElementById('register-extras').classList.toggle('hidden-sec', isLogin);
            document.getElementById('toggle-btn').innerText = isLogin ? "Register Now" : "Login Now";
            document.getElementById('auth-btn').innerText = isLogin ? "Login" : "Register";
        }

        function selectPlan(l) {
            selLvl = l;
            document.querySelectorAll('#register-extras div').forEach(d => d.classList.remove('border-2', 'border-blue-500'));
            document.getElementById('p-'+l).classList.add('border-2', 'border-blue-500');
        }

        function showTab(tab) {
            ['home-sec', 'task-sec', 'profile-sec'].forEach(s => document.getElementById(s).classList.add('hidden-sec'));
            document.getElementById(tab + '-sec').classList.remove('hidden-sec');
            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('text-blue-600'));
            document.getElementById('nav-' + tab).classList.add('text-blue-600');
        }

        async function handleAuth() {
            const email = document.getElementById('auth-email').value;
            const password = document.getElementById('auth-pass').value;
            const endpoint = isLogin ? '/api/login' : '/api/register';
            const res = await fetch(endpoint, {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({ email, password, level: selLvl })
            });
            const data = await res.json();
            if(data.success) {
                localStorage.setItem('user', JSON.stringify(data.user));
                location.reload();
            } else alert(data.error);
        }

        async function doTask() {
            const res = await fetch('/api/task', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({ email: user.email })
            });
            const data = await res.json();
            if(data.success) { alert("Task Complete!"); location.reload(); }
            else alert(data.error);
        }

        function logout() { localStorage.clear(); location.reload(); }

        window.onload = () => {
            if(user) {
                document.getElementById('auth-page').classList.add('hidden-sec');
                document.getElementById('bottom-nav').classList.remove('hidden-sec');
                showTab('home');
                document.getElementById('top-email').innerText = user.email;
                document.getElementById('prof-email').innerText = user.email;
                document.getElementById('user-balance').innerText = user.balance.toFixed(2);
                const plans = {1:"BASIC", 2:"SILVER", 3:"GOLD"};
                const lims = {1:10, 2:20, 3:30};
                document.getElementById('plan-name').innerText = plans[user.level];
                document.getElementById('prof-plan').innerText = plans[user.level];
                document.getElementById('tasks-left').innerText = lims[user.level] - (user.daily_count || 0);
                const st = document.getElementById('user-status');
                st.innerText = user.is_active ? "Verified" : "Unverified (Pay Fee)";
                st.className = user.is_active ? "text-[9px] font-bold text-green-500" : "text-[9px] font-bold text-red-500";
            }
        };
    </script>
</body>
</html>
